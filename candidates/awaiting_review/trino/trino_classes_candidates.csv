Class,Type,Commit Number,Commit Hash,Diff URL,Code Churn,Lines Added,Lines Deleted,Modified Files,From CBO,To CBO,From DIT,To DIT,From LCOM,To LCOM,From LOC,To LOC,From NOC,To NOC,From RFC,To RFC,From WMC,To WMC,Method Invocations,Refactoring Patterns
io.prestosql.cli.TestQueryRunner,class,16830 -> 16854,1c5b9215a2d1b04b5f84e2b3e861edf29bb82f7f -> f702af7c8b5a2486d5d6b463eae4288b279fe7ad,"['https://github.com/trinodb/trino/commit/a740219701f29cd457fcaa9d386cb1d0165c0b05', 'https://github.com/trinodb/trino/commit/1c5b9215a2d1b04b5f84e2b3e861edf29bb82f7f', 'https://github.com/trinodb/trino/commit/f702af7c8b5a2486d5d6b463eae4288b279fe7ad']",0,0,0,20,16.0,16.0,1.0,1.0,1.0,1.0,45.0,41.0,0.0,0.0,28.0,28.0,8.0,7.0,testCookie[ of():7 addHeader():4 nullPrintStream():4 takeRequest():3 assertEquals():3 getHeader():3 enqueue():3 renderOutput():2 createResults():2 setBody():2 url():2 startQuery():2 currentThread():1 setResponseCode():1 uri():1 empty():1 createQueryRunner():1 interrupt():1 ] createQueryRunner[ empty():15 ] createResults[ of():4 toJson():1 build():1 builder():1 setState():1 uri():1 url():1 ] setup[ start():1 ] teardown[ close():1 ] nullPrintStream[ nullOutputStream():1 ] ,"presto-cli/src/test/java/io/prestosql/cli/TestQueryRunner.java: [Extract Method(6), Add Parameter(6), Change Method Access Modifier(4), Add Method Modifier(2)]"
io.prestosql.plugin.hive.metastore.thrift.ThriftHiveMetastore,class,16694 -> 16718,996e160dd3e7142f31c25bfaf58a8ebb7d0e8fc3 -> fe5edd33364a4bb4b34f8e3382810a6298d52ab0,"['https://github.com/trinodb/trino/commit/a740219701f29cd457fcaa9d386cb1d0165c0b05', 'https://github.com/trinodb/trino/commit/25c73f7d0d268052f09a90ef764ad147da2d71d2', 'https://github.com/trinodb/trino/commit/996e160dd3e7142f31c25bfaf58a8ebb7d0e8fc3', 'https://github.com/trinodb/trino/commit/fe5edd33364a4bb4b34f8e3382810a6298d52ab0', 'https://github.com/trinodb/trino/commit/8814ed5bb5613c3e4a4586b0cb17f8ed2a3b125e', 'https://github.com/trinodb/trino/commit/3c63278ae11a711d931c6e84eae30947f66bf90c', 'https://github.com/trinodb/trino/commit/b5a6a8ff962a304fcdde48b27ebf7eb890b3daac']",0,0,0,13,61.0,61.0,1.0,1.0,585.0,585.0,901.0,901.0,0.0,0.0,253.0,252.0,191.0,191.0,buildPrivilegeBag[ add():1 getName():1 fromPrestoPrincipalType():1 getType():1 build():1 builder():1 ] getTableStatistics[ getTableColumnStatistics():1 getHiveBasicStatistics():1 getRowCount():1 getTable():1 stream():1 getCols():1 toImmutableList():1 getParameters():1 getSd():1 collect():1 map():1 orElseThrow():1 ] dropDatabase[ dropDatabase():1 stopOn():1 createMetastoreClient():1 stopOnIllegalExceptions():1 propagate():1 run():1 getDropDatabase():1 wrap():1 retry():1 ] getPartitionStatistics[ stream():4 collect():4 getOrDefault():2 toImmutableMap():2 map():2 toImmutableList():2 makePartName():1 getPartitionKeys():1 getPartitionsByNames():1 put():1 getPartitionColumnStatistics():1 getCols():1 of():1 builder():1 getSd():1 createEmptyStatistics():1 getHiveBasicStatistics():1 getRowCount():1 getValues():1 entrySet():1 copyOf():1 orElseThrow():1 getValue():1 getTable():1 build():1 getParameters():1 ] revokeRole[ getRevokeRole():1 revokeRole():1 stopOn():1 createMetastoreClient():1 stopOnIllegalExceptions():1 propagate():1 run():1 wrap():1 retry():1 ] getAllDatabases[ getGetAllDatabases():1 createMetastoreClient():1 stopOnIllegalExceptions():1 getAllDatabases():1 propagate():1 run():1 wrap():1 retry():1 ] createRole[ getCreateRole():1 stopOn():1 createMetastoreClient():1 stopOnIllegalExceptions():1 createRole():1 propagate():1 run():1 wrap():1 retry():1 ] getPartitionNamesByParts[ getGetPartitionNamesPs():1 stopOn():1 getPartitionNamesFiltered():1 createMetastoreClient():1 stopOnIllegalExceptions():1 of():1 propagate():1 run():1 wrap():1 retry():1 empty():1 ] revokeTablePrivileges[ toSet():3 stream():3 collect():3 map():2 buildPrivilegeBag():1 listTablePrivileges():1 getHivePrivilege():1 containsAllPrivilege():1 createMetastoreClient():1 isEmpty():1 revokePrivileges():1 checkArgument():1 run():1 getOnlyElement():1 empty():1 filter():1 contains():1 parsePrivilege():1 stopOnIllegalExceptions():1 propagate():1 wrap():1 retry():1 getRevokeTablePrivileges():1 ] getPartition[ getPartition():1 getGetPartition():1 stopOn():1 createMetastoreClient():1 stopOnIllegalExceptions():1 of():1 requireNonNull():1 propagate():1 run():1 wrap():1 retry():1 empty():1 ] updateTableStatistics[ getColumnStatistics():3 keySet():2 getKey():2 getTableStatistics():1 setTableColumnStatistics():1 setParameters():1 deleteTableColumnStatistics():1 fromMetastoreApiTable():1 stream():1 get():1 getColumn():1 map():1 getRowCount():1 apply():1 updateStatisticsParameters():1 entrySet():1 forEach():1 isEmpty():1 orElseThrow():1 deepCopy():1 getValue():1 getTable():1 getType():1 getParameters():1 toImmutableList():1 getBasicStatistics():1 difference():1 collect():1 alterTable():1 createMetastoreColumnStatistics():1 ] getPartitionColumnStatistics[ getValue():2 filter():1 toImmutableMap():1 getKey():1 getOrDefault():1 stream():1 entrySet():1 isEmpty():1 groupStatisticsByColumn():1 collect():1 getMetastorePartitionColumnStatistics():1 empty():1 ] propagate[ currentThread():1 interrupt():1 throwIfUnchecked():1 ] revokeRoles[ revokeRole():1 getName():1 fromPrestoPrincipalType():1 getType():1 ] alterPartition[ dropExtraColumnStatisticsAfterAlterPartition():1 alterPartitionWithoutStatistics():1 getPartitionName():1 storePartitionColumnStatistics():1 toMetastoreApiPartition():1 ] alterDatabase[ stopOn():1 getAlterDatabase():1 createMetastoreClient():1 stopOnIllegalExceptions():1 propagate():1 run():1 wrap():1 retry():1 alterDatabase():1 ] getTableColumnStatistics[ getTableColumnStatistics():1 stopOn():1 createMetastoreClient():1 stopOnIllegalExceptions():1 propagate():1 run():1 getGetTableColumnStatistics():1 groupStatisticsByColumn():1 wrap():1 retry():1 ] setPartitionColumnStatistics[ getKey():3 setPartitionColumnStatistics():2 entrySet():1 containsKey():1 createMetastoreClient():1 isEmpty():1 run():1 filter():1 getValue():1 getCreateDatabase():1 stream():1 stopOn():1 get():1 stopOnIllegalExceptions():1 toImmutableList():1 propagate():1 collect():1 map():1 wrap():1 retry():1 createMetastoreColumnStatistics():1 ] getPrestoViews[ getTableNamesByFilter():4 createMetastoreClient():4 addSuppressed():1 ] deletePartitionColumnStatistics[ getCreateDatabase():1 stopOn():1 deletePartitionColumnStatistics():1 createMetastoreClient():1 stopOnIllegalExceptions():1 propagate():1 run():1 wrap():1 retry():1 ] createDatabase[ createDatabase():1 getCreateDatabase():1 getName():1 stopOn():1 createMetastoreClient():1 stopOnIllegalExceptions():1 propagate():1 run():1 wrap():1 retry():1 ] dropRole[ dropRole():1 stopOn():1 createMetastoreClient():1 stopOnIllegalExceptions():1 propagate():1 run():1 getDropRole():1 wrap():1 retry():1 ] getFields[ getGetFields():1 getFields():1 stopOn():1 createMetastoreClient():1 stopOnIllegalExceptions():1 of():1 propagate():1 run():1 copyOf():1 wrap():1 retry():1 empty():1 ] getTable[ getGetTable():1 createMetastoreClient():1 run():1 empty():1 stopOn():1 getTable():1 getTableType():1 stopOnIllegalExceptions():1 equals():1 of():1 name():1 propagate():1 isPrestoView():1 wrap():1 retry():1 ] dropExtraColumnStatisticsAfterAlterPartition[ of():2 getColumnStatistics():1 getOrDefault():1 getColName():1 getStatistics():1 deletePartitionColumnStatistics():1 isEmpty():1 copyOf():1 getColumns():1 getMetastorePartitionColumnStatistics():1 getPartition():1 removeAll():1 stream():1 toImmutableList():1 getPartitionName():1 collect():1 map():1 keySet():1 ] isPrestoView[ equals():1 get():1 getParameters():1 ] groupStatisticsByColumn[ toImmutableMap():1 fromMetastoreApiColumnStatistics():1 stream():1 collect():1 ] alterTable[ stopOn():1 getTable():1 createMetastoreClient():1 stopOnIllegalExceptions():1 getAlterTable():1 isPresent():1 propagate():1 run():1 wrap():1 retry():1 alterTable():1 ] getStats[  ] createTable[ getDbName():2 createTable():1 stopOn():1 createMetastoreClient():1 stopOnIllegalExceptions():1 getTableName():1 propagate():1 run():1 getCreateTable():1 wrap():1 retry():1 ] setTableColumnStatistics[ getCreateDatabase():1 stopOn():1 createMetastoreClient():1 setTableColumnStatistics():1 stopOnIllegalExceptions():1 propagate():1 run():1 wrap():1 retry():1 ] getAllViews[ getGetAllViews():1 getPrestoViews():1 stopOn():1 stopOnIllegalExceptions():1 of():1 propagate():1 run():1 wrap():1 retry():1 ] alterPartitionWithoutStatistics[ getValues():1 stopOn():1 createMetastoreClient():1 stopOnIllegalExceptions():1 propagate():1 run():1 getAlterPartition():1 wrap():1 alterPartition():1 retry():1 ] containsAllPrivilege[ getPrivilege():1 stream():1 equalsIgnoreCase():1 anyMatch():1 ] updatePartitionStatistics[ getColumnStatistics():3 of():2 keySet():2 getPartitionStatistics():1 alterPartitionWithoutStatistics():1 getPartitionsByNames():1 getOnlyElement():1 setParameters():1 toImmutableMap():1 stream():1 get():1 getCols():1 requireNonNull():1 getSd():1 getRowCount():1 setPartitionColumnStatistics():1 apply():1 updateStatisticsParameters():1 deletePartitionColumnStatistics():1 valueOf():1 forEach():1 deepCopy():1 size():1 getType():1 getParameters():1 getBasicStatistics():1 difference():1 collect():1 ] addPartitionsWithoutStatistics[ size():2 format():2 addPartitions():1 stopOn():1 createMetastoreClient():1 stopOnIllegalExceptions():1 isEmpty():1 propagate():1 run():1 wrap():1 retry():1 getAddPartitions():1 ] getPartitionsByNames[ getGetPartitionsByNames():1 createMetastoreClient():1 isEmpty():1 checkArgument():1 run():1 getPartitionsByNames():1 stopOn():1 stopOnIllegalExceptions():1 of():1 requireNonNull():1 propagate():1 wrap():1 retry():1 ] getSupportedColumnStatistics[ getSupportedColumnStatistics():1 ] addPartitions[ stream():1 toImmutableList():1 getPartitionName():1 storePartitionColumnStatistics():1 addPartitionsWithoutStatistics():1 collect():1 map():1 ] deleteTableColumnStatistics[ getCreateDatabase():1 deleteTableColumnStatistics():1 stopOn():1 createMetastoreClient():1 stopOnIllegalExceptions():1 propagate():1 run():1 wrap():1 retry():1 ] dropTable[ stopOn():1 createMetastoreClient():1 stopOnIllegalExceptions():1 getDropTable():1 propagate():1 run():1 wrap():1 retry():1 dropTable():1 ] retry[ maxAttempts():1 stopOn():1 exponentialBackoff():1 retry():1 ] listTablePrivileges[ getName():2 listPrivileges():2 getType():2 add():1 fromPrestoPrincipalType():1 getPrincipalType():1 createMetastoreClient():1 getGrantInfo():1 run():1 getOwner():1 getPrincipalName():1 parsePrivilege():1 getTable():1 addAll():1 build():1 stopOnIllegalExceptions():1 equals():1 of():1 builder():1 propagate():1 getListTablePrivileges():1 wrap():1 retry():1 fromMetastoreApiPrincipalType():1 ] createMetastoreClient[ createMetastoreClient():1 ] getAllTables[ stopOn():1 createMetastoreClient():1 stopOnIllegalExceptions():1 getAllTables():1 of():1 propagate():1 run():1 retry():1 ] ThriftHiveMetastore[ getMinBackoffDelay():1 requireNonNull():1 getBackoffScaleFactor():1 getMaxRetries():1 getMaxBackoffDelay():1 getMaxRetryTime():1 ] storePartitionColumnStatistics[ getColumnStatistics():1 toImmutableMap():1 getPartition():1 getRowCount():1 getStatistics():1 setPartitionColumnStatistics():1 stream():1 isEmpty():1 getBasicStatistics():1 collect():1 getColumns():1 ] grantRoles[ getName():2 fromPrestoPrincipalType():2 getType():2 grantRole():1 ] getMetastorePartitionColumnStatistics[ getPartitionColumnStatistics():1 stopOn():1 createMetastoreClient():1 stopOnIllegalExceptions():1 getGetPartitionColumnStatistics():1 propagate():1 run():1 copyOf():1 wrap():1 retry():1 ] listRoles[ getRoleNames():1 stopOn():1 createMetastoreClient():1 stopOnIllegalExceptions():1 getListRoles():1 propagate():1 run():1 copyOf():1 wrap():1 retry():1 ] getDatabase[ getGetDatabase():1 getDatabase():1 stopOn():1 createMetastoreClient():1 stopOnIllegalExceptions():1 of():1 propagate():1 run():1 wrap():1 retry():1 empty():1 ] listRoleGrants[ getName():1 fromPrestoPrincipalType():1 createMetastoreClient():1 fromRolePrincipalGrants():1 run():1 listRoleGrants():1 stopOn():1 getType():1 getListRoleGrants():1 stopOnIllegalExceptions():1 propagate():1 wrap():1 retry():1 ] getPartitionNames[ getPartitionNames():1 stopOn():1 createMetastoreClient():1 stopOnIllegalExceptions():1 of():1 propagate():1 run():1 getGetPartitionNames():1 wrap():1 retry():1 empty():1 ] grantTablePrivileges[ getHivePrivilege():2 name():2 isContainedIn():2 next():1 buildPrivilegeBag():1 grantPrivileges():1 containsAllPrivilege():1 checkArgument():1 run():1 getOnlyElement():1 remove():1 empty():1 iterator():1 parsePrivilege():1 stream():1 stopOnIllegalExceptions():1 propagate():1 map():1 retry():1 listTablePrivileges():1 createMetastoreClient():1 format():1 isEmpty():1 hasNext():1 toSet():1 collect():1 wrap():1 getGrantTablePrivileges():1 ] grantRole[ stopOn():1 createMetastoreClient():1 stopOnIllegalExceptions():1 propagate():1 run():1 getGrantRole():1 grantRole():1 wrap():1 retry():1 ] dropPartition[ stopOn():1 getDropPartition():1 createMetastoreClient():1 stopOnIllegalExceptions():1 propagate():1 run():1 dropPartition():1 wrap():1 retry():1 ] ,presto-hive/src/main/java/io/prestosql/plugin/hive/metastore/thrift/ThriftHiveMetastore.java: [Extract Method(14)]
io.prestosql.sql.planner.optimizations.PlanNodeDecorrelator,class,16762 -> 16764,7cc8b1e28beb21523e7ed58cf3e5d83bce0c72e6 -> 9ce1b27ab4cb81124d618a63295d8c42392d9924,"['https://github.com/trinodb/trino/commit/a740219701f29cd457fcaa9d386cb1d0165c0b05', 'https://github.com/trinodb/trino/commit/2dd8761cf0efc67cd20b649bc3ffa8b148fa34a0', 'https://github.com/trinodb/trino/commit/7cc8b1e28beb21523e7ed58cf3e5d83bce0c72e6', 'https://github.com/trinodb/trino/commit/9ce1b27ab4cb81124d618a63295d8c42392d9924', 'https://github.com/trinodb/trino/commit/4fd5b1a1daed4f08449e635ed9c3fb6f14233eb2']",0,0,0,4,12.0,11.0,2.0,2.0,0.0,0.0,230.0,228.0,0.0,0.0,15.0,14.0,5.0,5.0,PlanNodeDecorrelator[ requireNonNull():2 ] containsCorrelation[ stream():1 union():1 anyMatch():1 extractOutputSymbols():1 extractUnique():1 ] decorrelatedNode[ containsCorrelation():1 of():1 empty():1 ] decorrelateFilters[ flatMap():1 resolve():1 decorrelatedNode():1 accept():1 ] ,"presto-main/src/main/java/io/prestosql/sql/planner/optimizations/PlanNodeDecorrelator.java: [Extract Method(33), Add Parameter(3)]"
io.prestosql.execution.scheduler.SimpleNodeSelectorFactory,class,16723 -> 16724,2e428afc8c9c85122fb243ae087a7f541205f7f4 -> 83b4e4ced6ec6711c7924d55d53b9ee225ef714d,"['https://github.com/trinodb/trino/commit/2e428afc8c9c85122fb243ae087a7f541205f7f4', 'https://github.com/trinodb/trino/commit/83b4e4ced6ec6711c7924d55d53b9ee225ef714d']",0,0,0,10,14.0,14.0,1.0,1.0,0.0,0.0,54.0,49.0,0.0,0.0,31.0,33.0,8.0,7.0,createNodeMap[ put():3 build():2 builder():2 getNodes():1 warn():1 getHostAndPort():1 stream():1 getInternalUri():1 of():1 getByName():1 collect():1 map():1 getHost():1 getIfPresent():1 getActiveConnectorNodes():1 getCoordinators():1 toImmutableSet():1 ] createNodeSelector[ createNodeMap():1 memoizeWithExpiration():1 ] SimpleNodeSelectorFactory[ requireNonNull():4 getMinCandidates():1 getMaxSplitsPerNode():1 isIncludeCoordinator():1 checkArgument():1 getOptimizedLocalScheduling():1 getMaxPendingSplitsPerTask():1 ] ,"presto-main/src/main/java/io/prestosql/execution/scheduler/SimpleNodeSelectorFactory.java: [Extract Class(10), Move Attribute(9)]"
io.prestosql.sql.planner.optimizations.PlanNodeDecorrelator$DecorrelatingVisitor,innerclass,16762 -> 16763,7cc8b1e28beb21523e7ed58cf3e5d83bce0c72e6 -> 7f9fc3ee76ef74fe7538cc43a5359d7f88382b47,"['https://github.com/trinodb/trino/commit/a740219701f29cd457fcaa9d386cb1d0165c0b05', 'https://github.com/trinodb/trino/commit/2dd8761cf0efc67cd20b649bc3ffa8b148fa34a0', 'https://github.com/trinodb/trino/commit/37f582a817caca02d587cffbf1aa372fb31336eb', 'https://github.com/trinodb/trino/commit/7cc8b1e28beb21523e7ed58cf3e5d83bce0c72e6', 'https://github.com/trinodb/trino/commit/7f9fc3ee76ef74fe7538cc43a5359d7f88382b47', 'https://github.com/trinodb/trino/commit/4fd5b1a1daed4f08449e635ed9c3fb6f14233eb2']",0,0,0,1,32.0,31.0,2.0,2.0,58.0,58.0,168.0,168.0,0.0,0.0,89.0,88.0,49.0,49.0,visitFilter[ of():5 copyOf():3 getSource():3 get():3 build():2 addAll():2 putAll():2 builder():2 resolve():1 partitioningBy():1 extractConjuncts():1 isPresent():1 union():1 accept():1 empty():1 containsCorrelation():1 getPredicate():1 stream():1 extractCorrelatedSymbolsMapping():1 getNextId():1 difference():1 collect():1 combineConjuncts():1 extractUnique():1 ] visitLimit[ empty():5 of():3 getOutputSymbols():2 getCount():2 resolve():1 containsAll():1 isEmpty():1 isPresent():1 accept():1 getConstantSymbols():1 getSource():1 get():1 getNextId():1 singleGroupingSet():1 ] extractCorrelatedSymbolsMapping[ contains():4 getRight():2 from():2 put():2 getLeft():2 build():1 equals():1 builder():1 getOperator():1 ] DecorrelatingVisitor[ requireNonNull():1 ] visitPlan[ of():4 ] visitAggregation[ empty():3 getGroupingKeys():3 of():2 containsAll():2 addAll():2 getSource():2 resolve():1 getStep():1 hasEmptyGroupingSet():1 isPresent():1 getCorrelatedSymbolMapper():1 getId():1 getHashSymbol():1 getConstantSymbols():1 stream():1 get():1 singleGroupingSet():1 builder():1 getAggregations():1 map():1 copyOf():1 accept():1 filter():1 contains():1 getGroupingSetCount():1 build():1 toImmutableList():1 collect():1 getGroupIdSymbol():1 ] isCorrelated[ stream():1 anyMatch():1 extractUnique():1 ] visitProject[ resolve():1 isPresent():1 getAssignments():1 copyOf():1 putIdentities():1 accept():1 empty():1 filter():1 contains():1 stream():1 build():1 getSource():1 get():1 putAll():1 of():1 getNextId():1 toImmutableList():1 builder():1 getOutputSymbols():1 collect():1 ] visitEnforceSingleRow[ filter():1 resolve():1 getSource():1 accept():1 ] ,"presto-main/src/main/java/io/prestosql/sql/planner/optimizations/PlanNodeDecorrelator.java: [Extract Method(33), Add Parameter(3)]"
